@startuml
'https://plantuml.com/component-diagram

left to right direction

package "Agent" {
    [Controller] as Agent_Controller
    package "Authentication" {
      [Presence Validator]
      [Network]
      [Visual]
    }

    package "Detections Framework Controller" {
      () "Detections Framework" as DF
      [Detections Dispatcher] -> DF
      [Detection] <- [Detections Dispatcher]
    }


    package EventChannel {
      Agent_Controller --> [Event]
      [Presence Validator] -> [Event]
      [Detections Dispatcher] --> [Event]
    }

    package "Scheduling" {
      [Timer] -> [Event]
    }

}

package "Client" {
    [Controller] as Client_Controller
    [Messages Dispatcher] <-- Client_Controller

    package [Applications] {
    }
}

package MessagesChannel {
    [Command] <- [Message]
    [Message]
    [Message] -> [Notification]
}


cloud "Remote Clients" {
}

[Applications] <-- [Messages Dispatcher]
[Applications] -> "Remote Clients"
Client_Controller -> [Message]
Agent_Controller -> [Message]

[Presence Validator] -> [Network]
[Visual] <- [Presence Validator]

@enduml